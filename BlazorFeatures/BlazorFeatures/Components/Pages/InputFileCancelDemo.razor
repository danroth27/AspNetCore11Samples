@page "/inputfile-cancel"
@rendermode InteractiveServer

<PageTitle>InputFile Cancel Event Demo</PageTitle>

<h1>InputFile Cancel Event</h1>

<p>The <code>InputFile</code> component now detects when file selection is canceled via the browser's <code>cancel</code> event.</p>

<div class="alert alert-info">
    <strong>Note:</strong> When the user cancels the file picker, the <code>OnChange</code> event fires with an empty file list. 
    Check <code>e.FileCount == 0</code> to detect cancellation.
</div>

<h2>Demo</h2>

<div class="mb-3">
    <InputFile OnChange="@HandleFileChange" class="form-control" multiple />
</div>

<div class="alert @statusClass">
    <strong>Status:</strong> @statusMessage
</div>

@if (selectedFiles.Any())
{
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Selected Files (@selectedFiles.Count)</h5>
            <ul>
                @foreach (var file in selectedFiles)
                {
                    <li>@file.Name (@file.Size bytes)</li>
                }
            </ul>
        </div>
    </div>
}

<h2>Code</h2>
<pre><code>&lt;InputFile OnChange="@@HandleFileChange" multiple /&gt;

@@code {
    void HandleFileChange(InputFileChangeEventArgs e)
    {
        if (e.FileCount == 0)
        {
            // User canceled file selection
            statusMessage = "File selection was canceled.";
        }
        else
        {
            // Files were selected
            selectedFiles = e.GetMultipleFiles().ToList();
        }
    }
}</code></pre>

@code {
    private List<IBrowserFile> selectedFiles = new();
    private string statusMessage = "Click the input to select files...";
    private string statusClass = "alert-info";

    private void HandleFileChange(InputFileChangeEventArgs e)
    {
        if (e.FileCount == 0)
        {
            // User canceled - the cancel event triggers OnChange with empty list
            selectedFiles.Clear();
            statusMessage = "File selection was canceled.";
            statusClass = "alert-warning";
        }
        else
        {
            selectedFiles = e.GetMultipleFiles().ToList();
            statusMessage = $"{e.FileCount} file(s) selected";
            statusClass = "alert-success";
        }
    }
}
